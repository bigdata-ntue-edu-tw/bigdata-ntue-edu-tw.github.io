import{d as A,o as P,G as r,s as S,Z as l,a as u,K as c,J as d,b as i,e as v,f as n}from"./firebase-917d75a2.js";import{r as m,H as h}from"./index-b5c83b15.js";let g=()=>{};const N=A("storeAuth",{state:()=>({user:{},loadPromise:new Promise(s=>g=s)}),actions:{init(){P(n,s=>{if(s){console.log(this.user),this.user.id=s.uid,this.user.email=s.email,console.log(this.user);const e=l(u,"users",s.uid);c(e).then(t=>{t.exists?this.user.role=t.data().role:console.log("No such document!")}).catch(t=>{console.error("Error getting document: ",t)})}else this.user={};g()})},googleSignIn(){const s=new r;S(n,s).then(e=>{r.credentialFromResult(e).accessToken;const o=e.user;let a=l(u,"users",o.uid);c(a).then(p=>{if(p.exists())return d(a,{name:o.displayName,email:o.email,updatedAt:i()},{merge:!0});{let f="student";return d(a,{name:o.displayName,email:o.email,role:f,updatedAt:i(),createdAt:i()})}})}).catch(e=>{console.log(e),e.code,e.message,e.customData.email,r.credentialFromError(e)}),m.replace({name:h})},logoutUser(){v(n).then(()=>{}).catch(s=>{}),m.replace({name:h})}}});export{N as u};
